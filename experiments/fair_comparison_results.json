{
  "config": {
    "d_model": 256,
    "vocab_size": 50257,
    "n_layers": 4,
    "n_heads": 8,
    "seq_len": 128,
    "batch_size": 32,
    "learning_rate": 0.0003,
    "max_steps": 2000,
    "eval_interval": 200,
    "mixed_precision": true,
    "gpu": "A100",
    "dataset": "wikitext-2",
    "seed": 42
  },
  "baseline_model": "Transformer_MHA",
  "baseline_stats": {
    "mean_ppl": 282.2647381813213,
    "std_ppl": 9.043026888915591,
    "n_runs": 3
  },
  "results": {
    "Transformer_MHA": {
      "success": true,
      "model_name": "Transformer_MHA",
      "parameters": 30221393,
      "eval_loss": 5.642845418429398,
      "perplexity": 282.2647381813213,
      "perplexity_std": 9.043026888915591,
      "n_runs": 3,
      "is_baseline": true,
      "cached": true
    },
    "Transformer_GQA": {
      "success": true,
      "model_name": "Transformer_GQA",
      "final_train_loss": 5.367480278015137,
      "eval_loss": 5.683687634468079,
      "perplexity": 294.03171464649597,
      "steps": 2000,
      "time_seconds": 61.20133686065674,
      "parameters": 29826641,
      "error": null,
      "gpu": "A100",
      "mixed_precision": true,
      "dataset": "wikitext-2",
      "seed": 42,
      "is_baseline": false
    },
    "Transformer_MQA": {
      "success": true,
      "model_name": "Transformer_MQA",
      "final_train_loss": 5.348880767822266,
      "eval_loss": 5.68375412940979,
      "perplexity": 294.051266918279,
      "steps": 2000,
      "time_seconds": 53.70865225791931,
      "parameters": 29760849,
      "error": null,
      "gpu": "A100",
      "mixed_precision": true,
      "dataset": "wikitext-2",
      "seed": 42,
      "is_baseline": false
    },
    "Transformer_Mamba": {
      "success": false,
      "model_name": "Transformer_Mamba",
      "final_train_loss": Infinity,
      "eval_loss": Infinity,
      "perplexity": Infinity,
      "steps": 0,
      "time_seconds": 19.625434160232544,
      "parameters": 0,
      "error": "The read operation timed out\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/httpx/_transports/default.py\", line 101, in map_httpcore_exceptions\n    yield\n  File \"/usr/local/lib/python3.11/site-packages/httpx/_transports/default.py\", line 250, in handle_request\n    resp = self._pool.handle_request(req)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py\", line 256, in handle_request\n    raise exc from None\n  File \"/usr/local/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py\", line 236, in handle_request\n    response = connection.handle_request(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/httpcore/_sync/connection.py\", line 103, in handle_request\n    return self._connection.handle_request(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/httpcore/_sync/http11.py\", line 136, in handle_request\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/httpcore/_sync/http11.py\", line 106, in handle_request\n    ) = self._receive_response_headers(**kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/httpcore/_sync/http11.py\", line 177, in _receive_response_headers\n    event = self._receive_event(timeout=timeout)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/httpcore/_sync/http11.py\", line 217, in _receive_event\n    data = self._network_stream.read(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/httpcore/_backends/sync.py\", line 126, in read\n    with map_exceptions(exc_map):\n  File \"/usr/local/lib/python3.11/contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/usr/local/lib/python3.11/site-packages/httpcore/_exceptions.py\", line 14, in map_exceptions\n    raise to_exc(exc) from exc\nhttpcore.ReadTimeout: The read operation timed out\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/root/cloud_train_fair.py\", line 265, in train_model\n    ds = load_dataset(\"wikitext\", \"wikitext-2-raw-v1\")\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/datasets/load.py\", line 1397, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/datasets/load.py\", line 1171, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/datasets/builder.py\", line 344, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/datasets/builder.py\", line 569, in _create_builder_config\n    builder_config._resolve_data_files(\n  File \"/usr/local/lib/python3.11/site-packages/datasets/builder.py\", line 207, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/datasets/data_files.py\", line 804, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/datasets/data_files.py\", line 757, in resolve\n    resolve_pattern(\n  File \"/usr/local/lib/python3.11/site-packages/datasets/data_files.py\", line 364, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/huggingface_hub/hf_file_system.py\", line 614, in glob\n    return super().glob(path, maxdepth=maxdepth, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/fsspec/spec.py\", line 642, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/huggingface_hub/hf_file_system.py\", line 653, in find\n    out = self._ls_tree(\n          ^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/huggingface_hub/hf_file_system.py\", line 557, in _ls_tree\n    for path_info in tree:\n  File \"/usr/local/lib/python3.11/site-packages/huggingface_hub/hf_api.py\", line 3156, in list_repo_tree\n    for path_info in paginate(path=tree_url, headers=headers, params={\"recursive\": recursive, \"expand\": expand}):\n  File \"/usr/local/lib/python3.11/site-packages/huggingface_hub/utils/_pagination.py\", line 36, in paginate\n    r = session.get(path, params=params, headers=headers)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/httpx/_client.py\", line 1053, in get\n    return self.request(\n           ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/httpx/_client.py\", line 825, in request\n    return self.send(request, auth=auth, follow_redirects=follow_redirects)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/httpx/_client.py\", line 914, in send\n    response = self._send_handling_auth(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/httpx/_client.py\", line 942, in _send_handling_auth\n    response = self._send_handling_redirects(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/httpx/_client.py\", line 979, in _send_handling_redirects\n    response = self._send_single_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/httpx/_client.py\", line 1014, in _send_single_request\n    response = transport.handle_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/httpx/_transports/default.py\", line 249, in handle_request\n    with map_httpcore_exceptions():\n  File \"/usr/local/lib/python3.11/contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/usr/local/lib/python3.11/site-packages/httpx/_transports/default.py\", line 118, in map_httpcore_exceptions\n    raise mapped_exc(message) from exc\nhttpx.ReadTimeout: The read operation timed out\n",
      "gpu": "A100",
      "mixed_precision": true,
      "dataset": "wikitext-2",
      "seed": 42,
      "is_baseline": false
    },
    "Transformer_Hybrid": {
      "success": true,
      "model_name": "Transformer_Hybrid",
      "final_train_loss": 5.116036891937256,
      "eval_loss": 5.492658157348632,
      "perplexity": 242.9020212620186,
      "steps": 2000,
      "time_seconds": 565.5282828807831,
      "parameters": 30699089,
      "error": null,
      "gpu": "A100",
      "mixed_precision": true,
      "dataset": "wikitext-2",
      "seed": 42,
      "is_baseline": false
    }
  }
}